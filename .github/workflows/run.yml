åç§°ï¼šäº‘æ£€æŸ¥æ“ä½œ
åœ¨:
  æ¨:
    åˆ†æ”¯:
      - ä¸»é¡µ
  è§‚çœ‹:
    ç±»å‹ï¼š å·²å¼€å§‹
  å·¥ä½œæµæ´¾é€:
  æ—¥ç¨‹å®‰æ’:
    - cron: 13 2 * * *
å·¥ä½œ:
  æ„å»ºå’Œéƒ¨ç½²:
    è¿è¡Œäºï¼šubuntu-latest
    ç¯å¢ƒï¼šç”¨æˆ·
    æ­¥éª¤:
      - åç§°: ğŸ”€ éšæœºå»¶è¿Ÿ 0-300 ç§’
        è¿è¡Œï¼š ç¡çœ  $((RANDOM % 301))

      - åå­—: ğŸ”Œ æŸ¥çœ‹ä»£ç 
        ä½¿ç”¨ï¼šactions/checkout@main

      - åç§°: ğŸ”¨ è®¾ç½® Node.js ç¯å¢ƒ
        ä½¿ç”¨ï¼šactions/setup-node@main
        ä¸ï¼š
          èŠ‚ç‚¹ç‰ˆæœ¬ï¼š 18
          ç¼“å­˜: npm

      - åç§°: ğŸ‘¾ æ£€æŸ¥è°ƒè¯•æ˜¯å¦ä¸ºçœŸ
        å¦‚æœï¼švars.debug == '1'
        è¿è¡Œï¼š |
          echo "CLOUD189_VERBOSE=1" >> $GITHUB_ENV
      
      - åç§°: ğŸ“¹ æ¢å¤ç¼“å­˜çš„Cookie
        idï¼š ç¼“å­˜-é¥¼å¹²-æ¢å¤
        ä½¿ç”¨ï¼šactions/cache/restore@v4
        ä¸ï¼š
          è·¯å¾„: .ä»¤ç‰Œ
          keyï¼š${{ runner.os }}-cache-token
          æ¢å¤å¯†é’¥ï¼š${{ runner.os }}-ç¼“å­˜ä»¤ç‰Œ-

      - åç§°: ğŸ”§ åˆå§‹åŒ–ç§˜å¯†
        ä½¿ç”¨ï¼šshine1594/ç¯å¢ƒè¡ŒåŠ¨çš„ç§˜å¯†@master
        ä¸ï¼š
          ç§˜å¯†ï¼š${{ toJSON(ç§˜å¯†) }}
          secrets_envï¼šç”Ÿäº§
          å‰ç¼€ç§¯ï¼š""
          file_name_prodï¼š.env

      - åç§°: ğŸ“¡ åˆå§‹åŒ–ä¾èµ–
        è¿è¡Œï¼š npm install

      - åç§°: ğŸš€ è¿è¡Œ
        ä½¿ç”¨ï¼šnick-fields/retry@master
        ä¸ï¼š
          è¶…æ—¶åˆ†é’Ÿæ•°ï¼š 30
          æœ€å¤§å°è¯•æ¬¡æ•°ï¼š 3
          å‘½ä»¤ï¼šnpm start
      
      - åç§°: ğŸ“¹ ä¿å­˜ç¼“å­˜çš„Cookie
        ä½¿ç”¨ï¼šactions/cache/save@v4
        ä¸ï¼š
          è·¯å¾„: .ä»¤ç‰Œ
          keyï¼š${{ runner.os }}-cache-token-${{ hashFiles(''.token/*.json') }}

      - åå­—: ğŸš— æŒç»­å¥”è·‘
        å¦‚æœï¼šgithub.äº‹ä»¶åç§° == 'è®¡åˆ’'
        è¿è¡Œï¼š |
          git config --local user.email "${{ github.actor_id }}+${{ github.actor }}@users.noreply.github.com"
          git config --local user.name "${{ github.actor }}"
          git remote set-url origin https://${{ github.actor }}:${{ github.token }}@github.com/${{ github.repository }}
          git æ‹‰å– -- é‡æ–°åˆå¹¶ -- è‡ªåŠ¨ä¿å­˜
          git commit --allow-empty -m "ç»§ç»­è¿è¡Œ..."
          git æ¨é€

      - name: ğŸ‰ åˆ é™¤æ—§çš„å·¥ä½œæµè¿è¡Œ
        ä½¿ç”¨ï¼š Mattraks/delete-workflow-runs@main
        ä¸ï¼š
          ä»¤ç‰Œï¼š${{ github.ä»¤ç‰Œ }}
          ä»£ç åº“: ${{ githubä»£ç åº“ }}
          ä¿ç•™å¤©æ•°ï¼š0
          ä¿æŒæœ€ä½è¿è¡Œæ¬¡æ•°ï¼š 50
